{"version":3,"file":"youtube.110d9f11bd034f2cda50.js","mappings":"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","sources":["webpack://film_info/./src/videotube.ts"],"sourcesContent":["(() => {\r\n\tconst throttle = (type, name, obj) => {\r\n\t\tobj = obj || window;\r\n\t\tlet running = false;\r\n\t\tconst func = function() {\r\n\t\t\tif (running) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\trunning = true;\r\n\t\t\trequestAnimationFrame(function() {\r\n\t\t\t\tobj.dispatchEvent(new CustomEvent(name));\r\n\t\t\t\trunning = false;\r\n\t\t\t});\r\n\t\t};\r\n\t\tobj.addEventListener(type, func);\r\n\t};\r\n\r\n\tthrottle(\"resize\", \"optimizedResize\");\r\n})();\r\n\r\n((obj) => {\r\n\tobj = obj || window;\r\n\tobj.animation = function(elem, prop, cb) {\r\n\t\tconst count = prop.count;\r\n\t\tlet counter = 0\r\n\t\tif (prop.start) {\r\n\t\t\tprop.start.forEach(item => {\r\n\t\t\t\telem.style[item[0]] = item[1]\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tconst allAnimation = [];\r\n\r\n\t\tprop.anim.forEach(([style, from, to]) => {\r\n\t\t\tconst max = Math.max(from, to);\r\n\t\t\tconst min = Math.min(from, to);\r\n\t\t\tconst step = (max - min) / count;\r\n\t\t\tallAnimation.push({style, from, to, step, reverse: min === to})\r\n\t\t});\r\n\r\n\r\n\t\tconst rafAnimation = () => {\r\n\r\n\t\t\tallAnimation.forEach((item) => {\r\n\t\t\t\tif (item.reverse) {\r\n\t\t\t\t\titem.from -= item.step\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem.from += item.step\r\n\t\t\t\t}\r\n\r\n\t\t\t\telem.style[item.style] = item.from;\r\n\t\t\t})\r\n\r\n\t\t\tcounter++;\r\n\t\t\tif (counter < count) {\r\n\r\n\t\t\t\trequestAnimationFrame(rafAnimation);\r\n\t\t\t} else {\r\n\t\t\t\tif (prop.end) {\r\n\t\t\t\t\tprop.end.forEach(item => {\r\n\t\t\t\t\t\telem.style[item[0]] = item[1]\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tif (cb) cb();\r\n\t\t\t}\r\n\r\n\r\n\t\t}\r\n\t\trequestAnimationFrame(rafAnimation);\r\n\t};\r\n})();\r\n\r\n\r\nconst init = () => {\r\n\r\n\tconst overlay = document.createElement('div');\r\n\toverlay.className = 'videotube-modal-overlay'\r\n\tdocument.body.insertAdjacentElement('beforeend', overlay);\r\n\r\n\tconst video = document.createElement('div');\r\n\tvideo.id = 'videotube-modal-container'\r\n\r\n\tconst sizeBlockList = [\r\n\t\t[3840, 2160],\r\n\t\t[2560, 1440],\r\n\t\t[1920, 1080],\r\n\t\t[1280, 720],\r\n\t\t[854, 420],\r\n\t\t[640, 360],\r\n\t\t[426, 240]\r\n\t];\r\n\r\n\r\n\tconst sizeVideo = () => {\r\n\t\tconst sizeBlock = sizeBlockList.find(item => item[0] < window.visualViewport.width) ||\r\n\t\t\tsizeBlockList[sizeBlockList.length - 1];\r\n\r\n\t\tconst iframe = document.getElementById('videotube-modal');\r\n\t\tiframe.width = sizeBlock[0];\r\n\t\tiframe.height = sizeBlock[1];\r\n\t\tvideo.style.cssText = `\r\n\t\t\twidth: ${sizeBlock[0]};\r\n\t\t\theight: ${sizeBlock[1]};\r\n\t\t`;\r\n\r\n\t}\r\n\r\n\tconst sizeContainer = () => {\r\n\r\n\t\tconst wh = window.visualViewport.height;\r\n\t\tconst ww = window.visualViewport.width;\r\n\t\tconst fw = video.style.width;\r\n\t\tconst fh = video.style.height;\r\n\r\n\t\tvideo.style.left = (ww - fw) / 2;\r\n\t\tvideo.style.top = (wh - fh) / 2;\r\n\t\toverlay.style.height = document.documentElement.clientHeight;\r\n\t}\r\n\r\n\tconst sizeVideoTubeModal = () => {\r\n\t\tsizeContainer();\r\n\t\tsizeVideo();\r\n\t}\r\n\r\n\tconst closeVideoTubeModal = () => {\r\n\r\n\t\tanimation(overlay, {\r\n\t\t\t\tend: [['display', 'none']],\r\n\t\t\t\tanim: [['opacity', 1, 0]],\r\n\t\t\t\tcount: 20,\r\n\t\t\t},\r\n\t\t\t() => {\r\n\t\t\t\toverlay.textContent = \"\";\r\n\t\t\t}\r\n\t\t);\r\n\t\twindow.removeEventListener(\"optimizedResize\", sizeVideoTubeModal);\r\n\t\tdocument.removeEventListener('keyup', closeContainerEsc);\r\n\t}\r\n\r\n\tconst closeContainerEsc = e => {\r\n\t\tif (e.keyCode === 27) {\r\n\t\t\tcloseVideoTubeModal();\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tconst openVideoTubeModal = e => {\r\n\t\t\tconst target = e.target.closest('.tube');\r\n\t\t\tif (!target) return;\r\n\r\n\t\t\tconst href = target.href;\r\n\t\t\tconst search = href.includes('youtube');\r\n\t\t\tlet idVideo = search ? href.match(/(\\?|&)v=([^&]+)/)[2] : href.match(/(\\.be\\/)([^&]+)/)[2];\r\n\r\n\t\t\tif (idVideo.length === 0) return;\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tanimation(overlay, {\r\n\t\t\t\t\tstart: [['display', 'block']],\r\n\t\t\t\t\tanim: [['opacity', 0, 1]],\r\n\t\t\t\t\tcount: 20,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\toverlay.insertAdjacentHTML('beforeend', `\r\n\t\t\t<div id=\"videotube-modal-loading\">Загрузка...</div>\r\n\t\t\t<div id=\"videotube-modal-close\">&#10006;</div>\r\n\t\t\t<div id=\"videotube-modal-container\">\r\n\t\t\t\t<iframe src=\"https://youtube.com/embed/${idVideo}?autoplay=1\" \r\n\t\t\t\t\tframeborder=\"0\"\r\n\t\t\t\t\tid=\"videotube-modal\" \r\n\t\t\t\t\tallowfullscreen\r\n\t\t\t\t\tallow=\"autoplay\">\r\n\t\t\t\t</iframe>\r\n\t\t\t</div>\r\n\t\t`)\r\n\r\n\t\t\tsizeVideo();\r\n\t\t\tsizeContainer();\r\n\r\n\t\t\twindow.addEventListener(\"optimizedResize\", sizeVideoTubeModal);\r\n\t\t\tdocument.addEventListener('keyup', closeContainerEsc);\r\n\t\t}\r\n\t;\r\n\r\n\r\n\toverlay.addEventListener(\"click\", closeVideoTubeModal);\r\n\tdocument.addEventListener('click', openVideoTubeModal)\r\n\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', init)\r\n"],"names":["obj","type","name","window","running","addEventListener","requestAnimationFrame","dispatchEvent","CustomEvent","throttle","animation","elem","prop","cb","count","counter","start","forEach","item","style","allAnimation","anim","from","to","max","Math","min","step","push","reverse","rafAnimation","end","document","overlay","createElement","className","body","insertAdjacentElement","video","id","sizeBlockList","sizeVideo","sizeBlock","find","visualViewport","width","length","iframe","getElementById","height","cssText","sizeContainer","wh","ww","fw","fh","left","top","documentElement","clientHeight","sizeVideoTubeModal","closeVideoTubeModal","textContent","removeEventListener","closeContainerEsc","e","keyCode","target","closest","href","idVideo","includes","match","preventDefault","insertAdjacentHTML"],"sourceRoot":""}